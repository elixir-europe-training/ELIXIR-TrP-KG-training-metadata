%%{ init: { "theme": "neutral", "themeVariables": {
    "background": "#ffffff",
    "primaryColor": "#ffffff",
    "primaryTextColor": "#1f2328",
    "lineColor": "#1f2328",
    "secondaryColor": "#e5f1ff",
    "tertiaryColor": "#f8fcff",
    "nodeBorder": "#1f2328",
    "edgeLabelBackground": "#ffffff",
    "noteBkgColor": "#fefefe",
    "noteTextColor": "#1f2328"
} } }%%
flowchart TD
    subgraph Inputs
        TESS_TTL["data/tess_harvest.ttl"]
        GTN_TTL["data/gtn_harvest.ttl"]
    end

    LOAD["loader.graph<br/>load_dataset()"]
    RESOURCES["loader.parser<br/>extract_resources_from_graph()"]
    DEDUPE["loader.dedupe<br/>select_richest()"]
    STORE["TrainingResource map"]
    DATASET["RDF Dataset"]

    subgraph IndexBuilders
        KEY["KeywordIndex.from_resources"]
        PROVIDER["ProviderIndex.from_resources"]
        LOC["LocationIndex.from_resources"]
        DATE["DateIndex.from_resources"]
        TOPIC["TopicIndex.from_resources"]
    end

    STATS["_build_stats()"]
    SERVICE["TrainingDataService<br/>(search_by_* & stats)"]

    TESS_TTL --> LOAD
    GTN_TTL --> LOAD
    LOAD --> DATASET
    LOAD --> RESOURCES
    RESOURCES --> DEDUPE --> STORE
    STORE --> KEY
    STORE --> PROVIDER
    STORE --> LOC
    STORE --> DATE
    STORE --> TOPIC
    STORE --> STATS
    KEY --> SERVICE
    PROVIDER --> SERVICE
    LOC --> SERVICE
    DATE --> SERVICE
    TOPIC --> SERVICE
    STATS --> SERVICE
