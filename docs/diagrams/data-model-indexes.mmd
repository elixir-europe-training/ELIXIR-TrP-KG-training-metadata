%%{ init: { "theme": "neutral", "themeVariables": {
    "background": "#ffffff",
    "primaryColor": "#ffffff",
    "primaryTextColor": "#1f2328",
    "lineColor": "#1f2328",
    "secondaryColor": "#e5f1ff",
    "tertiaryColor": "#f8fcff",
    "nodeBorder": "#1f2328",
    "edgeLabelBackground": "#ffffff",
    "noteBkgColor": "#fefefe",
    "noteTextColor": "#1f2328"
} } }%%
classDiagram
    class TrainingResource {
        +str uri
        +str name
        +str description
        +list[str] keywords
        +list[str] topics (EDAM IDs / labels)
        +Organization provider
        +list[str] access_modes
        +list[str] audience_roles
        +list[CourseInstance] course_instances
    }

    class CourseInstance {
        +datetime start_date
        +datetime end_date (optional)
        +str delivery_mode (optional)
        +str country
        +str? city
        +str place_id (OSM URL, optional)
    }

    class KeywordIndex {
        +lookup(tokens) set[str]
        -token -> set[uri]
    }

    class ProviderIndex {
        +lookup(provider_name) set[str]
        -normalized_name -> set[uri]
    }

    class LocationIndex {
        +lookup(country, city?) set[str]
        -country/city -> CourseSchedule
    }

    class DateIndex {
        +range(start?, end?) list[CourseSchedule]
        -sorted schedules
    }

    class TopicIndex {
        +lookup(edam_id_or_label) set[str]
        -identifier -> set[uri]
    }

    class CourseSchedule {
        +str resource_uri
        +datetime start
        +datetime end (optional)
        +str country
        +str? city
    }

    class TrainingDataStore {
        +dict[str, TrainingResource] resources_by_uri
        +KeywordIndex keyword_index
        +ProviderIndex provider_index
        +LocationIndex location_index
        +DateIndex date_index
        +TopicIndex topic_index
        +dict stats
    }

    TrainingResource "1" *-- "many" CourseInstance : course_instances
    TrainingDataStore "1" *-- "many" TrainingResource : resources_by_uri
    TrainingDataStore --> KeywordIndex
    TrainingDataStore --> ProviderIndex
    TrainingDataStore --> LocationIndex
    TrainingDataStore --> DateIndex
    TrainingDataStore --> TopicIndex
    LocationIndex --> CourseSchedule
    DateIndex --> CourseSchedule
